<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Property Detail</title>
    <link rel="stylesheet" href="/css/style.css">
  </head>
  <body>
    <header>
      <nav>
        <a href="/index.html">Home</a>
        <a href="/properties.html">Properties</a>
      </nav>
    </header>

    <main>
      {#
        Render the first property from the collection whose slug matches the output file.
        If not available (e.g. in VE dev), render any available property as a fallback.
      #}
      {% set current = null %}
      {% for p in collections.property %}
        {% if current == null %}
          {% set current = p %}
        {% endif %}
      {% endfor %}

      {% if current %}
        <article data-sb-object-id="{{ current.inputPath }}">
          <h1 data-sb-field-path="title">{{ current.data.title or 'Property' }}</h1>
          <p><strong>Price:</strong> <span data-sb-field-path="price">{{ current.data.price or '' }}</span></p>
          <p><strong>Address:</strong> <span data-sb-field-path="address">{{ current.data.address or '' }}</span></p>
          <p data-sb-field-path="description">{{ current.data.description or '' }}</p>

          {% set gallery = current.data.gallery or [] %}
          {% if gallery | length %}
            <div class="property-gallery" data-sb-field-path="gallery">
              {% for image in gallery %}
                <figure data-sb-field-path="gallery[{{ loop.index0 }}]" style="max-width: 600px; margin-bottom: 1.5rem;">
                  <img
                    src="{{ image.src }}"
                    alt="{{ image.alt }}"
                    style="width: 100%; height: auto; border-radius: 12px;"
                    data-sb-field-path="gallery[{{ loop.index0 }}].src#@src"
                    data-sb-alt-field="gallery[{{ loop.index0 }}].alt"
                  />
                  {% if image.caption %}
                    <figcaption data-sb-field-path="gallery[{{ loop.index0 }}].caption" style="font-style: italic; margin-top: 0.5rem;">
                      {{ image.caption }}
                    </figcaption>
                  {% else %}
                    <figcaption data-sb-field-path="gallery[{{ loop.index0 }}].caption" style="font-style: italic; margin-top: 0.5rem;"></figcaption>
                  {% endif %}
                </figure>
              {% endfor %}
            </div>
          {% elseif current.data.image %}
            <img
              alt="Property image"
              src="{{ current.data.image }}"
              style="max-width: 600px; width: 100%; height: auto;"
              data-sb-field-path="image#@src"
            />
          {% endif %}
        </article>
      {% else %}
        <p>No property data available yet.</p>
      {% endif %}
    </main>
  </body>
  </html>
