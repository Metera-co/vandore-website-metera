---
permalink: single_blog.html
layout: layouts/base.njk
eleventyExcludeFromCollections: true
---
{% set posts = blogs or [] %}
{% block content %}
<section class="vh-section vh-section--blog-detail" data-blog-detail-root>
  <div class="vh-container">
    {% if posts | length %}
      {% for post in posts %}
        <article class="vh-blog-detail" data-blog-article data-slug="{{ post.slug }}" data-cms-collection="blog" data-cms-item="{{ post.slug }}"{% if not loop.first %} hidden aria-hidden="true"{% endif %}>
          <header class="vh-blog-detail__header">
            <p class="vh-blog-detail__meta">
              {% if post.date %}
                <span data-cms-bind="date">{{ post.date }}</span>
              {% endif %}
              {% if post.readingTime %}
                <span data-cms-bind="readingTime">{{ post.readingTime }}</span>
              {% endif %}
              {% if post.categories %}
                {% for category in post.categories %}
                  <span class="vh-badge" data-cms-bind="categories[{{ loop.index0 }}]">{{ category }}</span>
                {% endfor %}
              {% endif %}
            </p>
            <h1 class="vh-blog-detail__title" data-cms-bind="title">{{ post.title }}</h1>
            {% if post.summary %}
              <p class="vh-blog-detail__summary" data-cms-bind="summary">{{ post.summary }}</p>
            {% endif %}
            {% if post.author %}
              <p class="vh-blog-detail__author" data-cms-bind="author">{{ post.author }}</p>
            {% endif %}
          </header>

          {% if post.image %}
            <figure class="vh-blog-detail__hero">
              <img src="{{ post.image }}" alt="{{ post.image_alt or post.title }}" data-cms-bind="image">
              {% if post.image_alt %}
                <figcaption data-cms-bind="image_alt">{{ post.image_alt }}</figcaption>
              {% endif %}
            </figure>
          {% endif %}

          <div class="vh-blog-detail__body">
            {% if post.body %}
              <div class="vh-rich-text" data-cms-bind="body">{{ post.body | safe }}</div>
            {% elseif post.content %}
              {% for paragraph in post.content %}
                <p data-cms-bind="content[{{ loop.index0 }}]">{{ paragraph }}</p>
              {% endfor %}
            {% endif %}
          </div>

          {% if post.tags %}
            <div class="vh-blog-detail__tags">
              <h2>Tags</h2>
              <ul>
                {% for tag in post.tags %}
                  <li data-cms-bind="tags[{{ loop.index0 }}]">{{ tag }}</li>
                {% endfor %}
              </ul>
            </div>
          {% endif %}

          {% if posts | length > 1 %}
            <aside class="vh-blog-detail__related">
              <h2>More Articles</h2>
              <ul>
                {% for other in posts %}
                  {% if other.slug != post.slug %}
                    <li data-cms-collection="blog" data-cms-item="{{ other.slug }}">
                      <a href="/single_blog.html?slug={{ other.slug }}">
                        <span data-cms-bind="title">{{ other.title }}</span>
                      </a>
                    </li>
                  {% endif %}
                {% endfor %}
              </ul>
            </aside>
          {% endif %}
        </article>
      {% endfor %}
    {% else %}
      <div class="vh-empty">
        <p>No blog posts available.</p>
      </div>
    {% endif %}
  </div>
</section>
{% endblock %}

{% block scripts %}
  <script>
    (function () {
      const params = new URLSearchParams(window.location.search);
      const requestedSlug = params.get('slug');
      const articles = document.querySelectorAll('[data-blog-article]');
      if (!articles.length) return;

      let matchFound = false;
      articles.forEach((article, index) => {
        const shouldShow = requestedSlug ? article.dataset.slug === requestedSlug : index === 0;
        if (shouldShow) {
          article.hidden = false;
          article.setAttribute('aria-hidden', 'false');
          matchFound = true;
        } else {
          article.hidden = true;
          article.setAttribute('aria-hidden', 'true');
        }
      });

      if (requestedSlug && !matchFound) {
        const first = articles[0];
        first.hidden = false;
        first.setAttribute('aria-hidden', 'false');
      }
    })();
  </script>
{% endblock %}